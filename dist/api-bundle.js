module.exports=function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="/dist/",n(n.s=10)}([function(e,n){e.exports=require("rxjs/Rx")},function(e,n){e.exports=require("firebase/auth")},function(e,n){e.exports=require("firebase/app")},function(e,n){e.exports=require("firebase/database")},function(e,n){e.exports=require("isomorphic-fetch")},function(e,n){e.exports=require("firebase/messaging")},function(e,n){e.exports=require("googleapis")},function(e,n){e.exports=require("mongoose")},function(e,n){e.exports=require("bcrypt-nodejs")},function(e,n){e.exports=require("jsonwebtoken")},function(e,n,t){"use strict";function r(e){return 0===P.apps.length&&(console.log(e),P.initializeApp(e)),P.database()}function o(){return{apiKey:process.env.FIREBASE_API_KEY,authDomain:process.env.FIREBASE_DOMAIN_KEY,databaseURL:process.env.FIREBASE_DATABASE_URL,projectId:process.env.FIREBASE_PROJECT_ID,storageBucket:process.env.FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.FIREBASE_MESSAGING_SENDER_ID}}function i(){return{type:"service_account",project_id:"kevchat-a5b6f",private_key_id:"dc4806e84c1c43064e683884b9e62a2bb12e3319",private_key:"-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDU4J75tKyjWSQX\nWL4qww8i6xW51NTEdxxZXmYt3WuYpCpfFzpYU40KggPsTGl55cqzoOY3Py7g1mjm\nbTwCAujc7w2ceQnoAodZmQy9V8q3ygb+1rtNjjQF0SIAN3eoYbrXBfNYAhlrZS3G\n8mTJdvbsBsfYXn+NbazXzIvEuI2RZyRZkMtLNd+LklCfF9dIGX9Z/hyRIikqYt49\npanK8iTBI/ux6W62RPIfpuPWvUCdabVOJTfZ19qJLsi3S5kzqRTwzeTFU+fa3SUv\n9cUBdnmWEgfmWo9I8/6s+Hdt5R+QkrrMgfn0DOd0HD5x5zkwAdS+Sk87eVCOtUny\nb9zlofFNAgMBAAECggEAXFJwT95eEte5kdCAZN5EpcGrofTeM7humImaqeCB5eio\noaXavWy62ehKGESJZ/7TOrUYsrQZuhPy2aBdKoglgo/AaPCLbc4O8jowrrsw5SVe\nhE4PXFLEWBN7efmUUPfVhqSDhVMfwBZY1JPSRxdrfjBwonNVQTpkABErOq1JZFm6\nt2qHNFDMspwhYrbChYZN9Ijbvpv64XiejYM/rP/+Dpb5o1LwpyL6vJ8Z0xj9g65l\ncQZcITXgdi+lQDzbCR9sQ+2n/xlMiutFTsFqhL6giuQcNU/eD0l6wp4wPj8PqRMr\n3fLgPdErdTlB7rYPo1No3fuGAoz8yo9UpwLykjhCdwKBgQD3EmrJ6CHueyNqj7ek\nlHivjdSbyxjCeMwur5M1w+dqKBwDXAOtQ+sBm0IZ8fZHLCxJFhlAM6ejlCZiF0O2\nij2r2lr4X8/IW2ESeOTXJx8mvuLIA0T7865GupLM6hYoztodVTUsdv3uTz2/wmlR\nPWZecz7TTVd6QvPfsaOtY2wccwKBgQDckeGkP2D6XDSo538G1vtlD+aK+EDA4XcN\nmrXrLHbaMFxwjr5/w0g14h3x6gxIJwvGe5d2CwVk4zUEcihO1d+tfgePr4vKiuAp\nKQGrO0bu0FC9smIN/1GUjHYhzIqUWHeryA8CQQTbHs0OVm5hIfhKW7RGPl24oZBK\nC7I8XnoLPwKBgQCVhEOzpBLEqygnmIldw6u1MXN0RFfbeBa4OfAwHTmx+EvbjJd9\nBxj0g+xgnxiWwZibMhBd1eShDUqdGc8UbFwd36olnHW1nfcEorx5p2cmn2XF/JSG\nlFTm4IluEEsQrv03uxTOr8PDr5iCrzfkve9xQPTIEonZpyLGQE34463NGQKBgFkb\nZjjgkeES1wNVYm/08eLGJbEG0cIaU+pfEhdMA0fqOa4PPM6Iqed6zfYpQ4TyoUMy\nMuIxWaCEWarOI5KVvKNuQse9d4//wsdeFZqDfAiGh9fa9NoKx35nsGG/LEz54H65\nd7bFZZzQOK8OI9GB07jWi2HFWD96pbwENaFF2bApAoGBANUnVJxW0fJMh/9sYwQH\nmedP7aV7nLIFdG988p53wdvQN7CF40wCOckvW/bG/I83a7dibSj274EYSIa1deWb\nCWS+UsiNqMKgQgtzk4Id4AmLF0AVksJKH36+cP2PLexNdocL4Ku9T71IqsZn0JvC\nWaIK9klqvoH0aLg5XOJw5Zyg\n-----END PRIVATE KEY-----\n",client_email:"firebase-adminsdk-7fhc2@kevchat-a5b6f.iam.gserviceaccount.com",client_id:"112694782557192835677",auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://accounts.google.com/o/oauth2/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-7fhc2%40kevchat-a5b6f.iam.gserviceaccount.com"}}function s(e){return 0===P.apps.length&&P.initializeApp(e),P.auth().signInWithEmailAndPassword(process.env.FIREBASE_EMAIL,process.env.FIREBASE_PASSWORD).catch(function(e){var n=e.code,t=e.message;return console.error("Sign in failed ("+n+"): "+t),e})}function u(e){return B(this,void 0,void 0,function(){var n,t,r,o;return N(this,function(i){switch(i.label){case 0:return n=e.userId,t=e.lang,console.log("inside retrieveNotificationKey"),r="zh-hk"===t?"zh_hk":"en",[4,T("https://android.googleapis.com/gcm/notification?notification_key_name="+n+"_"+r,{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"key="+process.env.FIREBASE_SERVER_KEY,project_id:process.env.FIREBASE_MESSAGING_SENDER_ID}),body:JSON.stringify({})}).then(function(e){return e.json()}).then(function(e){if(e.error)throw new Error(e.error);return e}).catch(function(e){console.error("userGroups: failed to retrieve notification key from userId "+n+": "+e)})];case 1:return o=i.sent(),console.info(o),[2,o.notification_key]}})})}function a(e,n){return F(this,void 0,void 0,function(){var t;return j(this,function(r){return t=T("https://fcm.googleapis.com/fcm/send",{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"key="+process.env.FIREBASE_SERVER_KEY,project_id:process.env.FIREBASE_SERVER_KEY}),body:JSON.stringify({to:e,notification:n,data:{volume:"3.21.15",contents:"http://www.news-magazine.com/world-week/21659772"},message:{notification:n}})}).then(function(e){return e.json()}).then(function(e){if(console.log(e),e.error)throw new Error(e)}).catch(function(e){console.error(e)}),[2,t]})})}function c(e){var n=(r(o()),{title:e.title,body:e.message}),t={userId:e.userId,lang:e.lang};return O.Observable.fromPromise(u(t)).flatMap(function(e){return console.info("found notification id: "+e),O.Observable.fromPromise(a(e,n))}).flatMap(function(e){return O.Observable.of(R({},e,{status:"success"}))})}function f(e,n,t,r){var o;c(e).subscribe(function(e){o={status:"success",result:e}},function(e){o={status:"failure",result:e}},function(){console.info(o),t.send(JSON.stringify(o))})}function l(){return new Promise(function(e,n){var t=i();new G.auth.JWT(t.client_email,void 0,t.private_key,q,void 0).authorize(function(t,r){if(t)return void n(t);console.log("fuck"),console.log(r),e(r.access_token)})})}function d(e,n){return M(this,void 0,void 0,function(){var t,r;return C(this,function(o){switch(o.label){case 0:return[4,l()];case 1:return t=o.sent(),console.log(t),r=T(process.env.FIREBASE_PUSH_NOTIFICATION_WEB,{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+t}),body:JSON.stringify({message:{token:e,notification:n}})}).then(function(e){return e.json()}).then(function(e){if(console.log(e),e.error)throw new Error(e)}).catch(function(e){console.error(e)}),[2,r]}})})}function p(e,n){return M(this,void 0,void 0,function(){return C(this,function(e){return[2,"foo"]})})}function h(e,n){return M(this,void 0,void 0,function(){return C(this,function(e){return[2,"foo"]})})}function b(e,n,t){return M(this,void 0,void 0,function(){var r;return C(this,function(o){switch(o.label){case 0:switch(r=e){case"web":return[3,1];case"android":return[3,3];case"ios":return[3,5]}return[3,7];case 1:return[4,d(n,t)];case 2:return[2,o.sent()];case 3:return[4,p(n,t)];case 4:return[2,o.sent()];case 5:return[4,h(n,t)];case 6:return[2,o.sent()];case 7:return[2]}})})}function v(e){var n={title:e.title,body:e.message};return O.Observable.fromPromise(b(e.type,e.token,n)).flatMap(function(){return O.Observable.of({status:"success",msg:"message sent to token "+e.token})})}function g(e,n,t,r){var o;v(e).subscribe(function(e){o={status:"success",result:e}},function(e){o={status:"failure",result:e}},function(){console.info(o),t.send(JSON.stringify(o))})}function w(e,n){return K(this,void 0,void 0,function(){var t,r;return Q(this,function(i){switch(i.label){case 0:return[4,s(o())];case 1:return t=i.sent(),[4,e.ref("/users/"+n).once("value")];case 2:return r=i.sent(),[2,r.val()]}})})}function y(e){var n=new L({userId:e.userId,token:e.token,lang:e.lang,type:e.type});return console.log(e),O.Observable.create(function(t){L.findOneAndUpdate({token:e.token},n,{upsert:!0,new:!0},function(e,n){e&&t.error({status:"failure",msg:"database error"}),t.next({status:"success",msg:"token saved",result:n})})})}function m(e,n,t,r){var o=(e.userId,e.token,e.lang,{status:"success",result:[]});y(e).subscribe(function(e){o.result.push(e),console.log(e)},function(e){o.status="failure",o.result.push({status:"failure",result:e})},function(){console.log("finished, sending the stuff"),console.info(o),t.send(JSON.stringify(o))})}function k(e,n,t,i){return W(this,void 0,void 0,function(){var n,i,s;return U(this,function(u){switch(u.label){case 0:return i=r(o()),[4,w(i,e)];case 1:return s=u.sent(),n={status:"success",result:s},t.send(JSON.stringify(n)),[2]}})})}function E(e,n,t){var r=new X({userId:e.body.userId,password:e.body.password});X.findOne({userId:e.body.userId},function(o,i){if(o&&n.send({status:"failure",msg:"database error"}),i)return void n.send({status:"failure",msg:"Account with that userId "+e.body.userId+" already exists."});r.save(function(e){if(e)return t(e);var o=V.sign({id:r._id},"linkinpark",{expiresIn:86400});n.send({status:"success",auth:!0,token:o})})})}function I(e,n,t){X.findOne({userId:e.body.userId},function(t,r){if(t)return n.status(500).send("Error on the server.");if(!r)return n.status(404).send("No user found.");if(!Y.compareSync(e.body.password,r.password))return n.status(401).send({auth:!1,token:null});var o=V.sign({id:r._id},"linkinpark",{expiresIn:86400});n.status(200).send({auth:!0,token:o})})}function x(e,n,t){var r=e.headers["x-access-token"];if(!r)return n.status(401).send({auth:!1,message:"No token provided."});V.verify(r,"linkinpark",function(e,t){if(e)return n.status(500).send({auth:!1,message:"Failed to authenticate token."});n.status(200).send({auth:!0,message:"Authenticated with token!",decoded:t})})}function _(e,n,t,r){X.findOne({userId:e},function(e,n){if(e)return r(e);n?t.send({status:"found",msg:"Account with that user id already exists."}):t.send({status:"not found",msg:"Account with that user id is available."})})}function S(e){return $(this,void 0,void 0,function(){var n,t;return ee(this,function(r){return(n=e.headers["x-access-token"])?(t=new Promise(function(e,t){V.verify(n,"linkinpark",function(n,t){n&&e(-1),e(1)})}),[2]):[2,-1]})})}function A(e){var n=this;e.use(function(e,t,r){return $(n,void 0,void 0,function(){var n,o;return ee(this,function(i){switch(i.label){case 0:return(e.url.indexOf("/user/")>=0||e.url.indexOf("/api/")>=0)&&e.url.indexOf("/user/login")<0&&e.url.indexOf("/user/signup")<0?(console.log("verifying token"),n=e.headers["x-access-token"],n?[4,new Promise(function(e,t){V.verify(n,"linkinpark",function(n,t){n&&e(!1),e(!0)})})]:[2,t.status(401).send({auth:!1,message:"No token provided."})]):[3,2];case 1:return o=i.sent(),(console.log("finishing verifying token"),o)?(r(),[3,3]):[2,t.status(500).send({auth:!1,message:"Failed to authenticate token."})];case 2:r(),i.label=3;case 3:return[2]}})})}),e.post("/api/direct-message",function(e,n,t){var r=e.body;g({title:r.title,message:r.message,token:r.token,type:r.type},e,n,t)}),e.post("/api/custom-message",function(e,n,t){var r=e.body;f({userId:r.userId,title:r.title,message:r.message,lang:r.lang},e,n,t)}),e.post("/api/token",function(e,n,t){console.log("handling api/token");var r=e.body;m({type:r.type,lang:r.lang,token:r.token,userId:r.userId},e,n,t)}),e.get("/api/tokens/:userId",function(e,n,t){k(e.params.userId,e,n,t)}),e.post("/user/signup",function(e,n,t){E(e,n,t)}),e.get("/user/check/:userId",function(e,n,t){_(e.params.userId,e,n,t)}),e.post("/user/login",function(e,n,t){I(e,n,t)}),e.post("/user/auth",function(e,n,t){x(e,n,t)})}Object.defineProperty(n,"__esModule",{value:!0});var O=t(0),P=t(2);t(3),t(1);global.XMLHttpRequest=t(11).XMLHttpRequest;var T=t(4),B=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})},N=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},F=(t(6),t(5),this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})}),j=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},R=this&&this.__assign||Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},G=t(6),q="https://www.googleapis.com/auth/firebase.messaging",M=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})},C=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},K=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})},Q=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},z=t(7),D=new z.Schema({userId:String,token:String,lang:String,type:String},{timestamps:!0}),J=z.model("Token",D),L=J,W=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})},U=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},Y=t(8),Z=new z.Schema({userId:String,password:String},{timestamps:!0});Z.pre("save",function(e){var n=this;if(!n.isModified("password"))return e();Y.genSalt(10,function(t,r){if(t)return e(t);Y.hash(n.password,r,void 0,function(t,r){if(t)return e(t);n.password=r,e()})})}),Z.methods.comparePassword=function(e,n){Y.compare(e,this.password,function(e,t){n(e,t)})};var H=z.model("User",Z),X=H,V=t(9);n.verifyAuthToken=S,n.default=A;var $=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(s,u)}a((r=r.apply(e,n||[])).next())})},ee=this&&this.__generator||function(e,n){function t(e){return function(n){return r([e,n])}}function r(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(e,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u}},function(e,n){e.exports=require("xmlhttprequest")}]);